# Subreddit Post Sentiment Classification
Reddit is made of threads that contain posts generated by the users. This project aims to predict the sentiment polarity of each post individually. The exercise dataset contains our target column called `sentiment.polarity` which can take 5 values: "very negative", "negative", "neutral", "positive" and "very positive" (multi-label classification/prediction).

## Project Desciption
### Training and Evaluation
This project tokenizes and normalises the text from Reddit posts (known as "body") before training using different classification models using the Scikit Learn package. The labels to predict are the `sentiment.polarity` for each post. This project uses the following combinations of classifier models and feature representations to train and evaluate different experiments:
1. Dummy Classifier with strategy="most_frequent".
2. Dummy Classifier with strategy="stratified".
3. LogisticRegression with One-hot vectorization.
4. LogisticRegression with TF-IDF vectorization (default settings).
5. SVC Classifier with One-hot vectorization (SVM with RBF kernel, default settings).

For the above classifiers, this project reports the classifier accuracy as well as macro-averaged precision, recall, and F1 (to three decimal places). Overall results obtained by the classifiers on the test sets are shown in the below table, and the best performance classifier (by weighted F1 in the test set) is highlighted.

![image](https://user-images.githubusercontent.com/66486975/148645714-de6443ee-8f27-4d22-a51f-a670c8bdfd62.png)

For the best performing classifier a bar chart graph is shown with the F1 score for each class - (sentiment polarity labels on x-axis, F1 score on y-axis).

<img src="https://user-images.githubusercontent.com/66486975/148645725-9ec190bf-96bb-49b6-bb9b-26b47c406bfc.png" height="320">

### Parameter Tuning
This project tunes the below parameters for both the vectorizer and classifier on the validation set.
- Classifier - Regularization C value (from 10^-3 to 10^5).
- Vectorizer - Parameters: sublinear_tf and max_features (in a range None to 50k).

On evaluating the resulting tuned model has improved over the baseline TF-IDF model, and the results of the best-tuned model and the baseline model are compared and shown in the below table with the accuracy, macro-averaged precision, recall, and F1 on the test data.
|          Model          | Accuracy | Precision | Recall | F1 Score |
| ----------------------- |:--------:|:---------:|:------:|:--------:|
|  Baseline TF-IDF Model  |  0.727   |   0.323   | 0.607  |   0.345  |
| Best Tuned TF-IDF Model |  0.736   |   0.447   | 0.601  |   0.496  |

As part of the study, this project also leverages embedding-based features on the train dataset to see the performance of the model.

### API Creation and Dockerization
The best-tuned model was saved to a pickle file and is used to build an API in Flask that predicts the sentiment polarity from input text in a post and also predicts sentiment polarities as an array, for different text inputs passed as an input file. This API is read and implemented with the help of Swagger using the Flasgger package, which generates an interactive and autogenerated UI. Finally, the entire application is dockerized and built as an image, which is then pushed to the Docker Hub and made publicly available.

## Code and API Execution
The entire code for training and evaluating different models is carried out in the notebook file `Subreddit_Post_Sentiment_Classification.ipynb`.

To run the entire dockerized application for predicting the sentiment polarity from the input post:
- Pull the image from the Docker Hub using the command,
  ```shell
  docker pull salman418/sentiment-classifier
  ```
- This API runs on port 8000.
- To run the container, based on the image salman418/sentiment-classifier, use the following command,
  ```shell
  docker run -p 8000:8000 --rm --name sentiment-classifier_app salman418/sentiment-classifier
  ```
  This will run the container named sentiment-classifier_app (can give any names of your choice) on your localhost.
- Connect to your localhost with swagger as http://localhost:8000/apidocs.
- Use the predict and predict_file tabs to get the predicted responses of your input.
- To stop the container, use the command,
  ```shell
  docker stop sentiment-classifier_app
  ```
